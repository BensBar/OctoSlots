<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFL 4K Slots</title>
    <style>
        /* ... (previous CSS remains the same) ... */
        .reel {
            width: var(--reel-size);
            height: var(--reel-size);
            background: #fff;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 15px rgba(255,255,255,0.3);
        }

        .reel-strip {
            position: absolute;
            width: 100%;
            display: flex;
            flex-direction: column;
            transition: transform 2s cubic-bezier(0.21, 0.53, 0.29, 0.99);
        }

        .symbol {
            width: var(--reel-size);
            height: var(--reel-size);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10%;
            box-sizing: border-box;
        }

        .symbol img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* ... (rest of CSS remains the same) ... */
    </style>
</head>
<body>
    <!-- ... (HTML structure remains the same) ... -->

    <script>
        // Game configuration with all NFL teams
        const CONFIG = {
            reels: 3,
            symbols: [
                'bills', 'dolphins', 'patriots', 'jets',
                'ravens', 'bengals', 'browns', 'steelers',
                'texans', 'colts', 'jaguars', 'titans',
                'broncos', 'chiefs', 'raiders', 'chargers',
                'cowboys', 'giants', 'eagles', 'commanders',
                'bears', 'lions', 'packers', 'vikings',
                'falcons', 'panthers', 'saints', 'buccaneers',
                'cardinals', 'rams', 'seahawks', '49ers'
            ],
            paylines: 25,
            minBet: 1,
            maxBet: 100,
            credits: 1000
        };

        class NFLSlots {
            constructor() {
                this.credits = CONFIG.credits;
                this.currentBet = CONFIG.minBet;
                this.spinning = false;
                this.symbols = [];
                this.reelStrips = [];
                this.init();
            }

            async init() {
                await this.preloadImages();
                this.setupReels();
                this.updateCredits();
                this.setupEventListeners();
            }

            async preloadImages() {
                const preloadPromises = CONFIG.symbols.map(team => {
                    return new Promise((resolve, reject) => {
                        const img = new Image();
                        img.onload = () => resolve(img);
                        img.onerror = () => {
                            console.warn(`Failed to load logo for ${team}`);
                            resolve(null); // Don't reject, just mark as unavailable
                        };
                        img.src = `logos/${team}.png`;
                        this.symbols[team] = img;
                    });
                });

                await Promise.all(preloadPromises);
            }

            setupReels() {
                const reels = document.querySelectorAll('.reel');
                reels.forEach((reel, i) => {
                    const strip = document.createElement('div');
                    strip.className = 'reel-strip';
                    this.reelStrips[i] = strip;
                    
                    // Create double set of symbols for seamless spinning
                    [...CONFIG.symbols, ...CONFIG.symbols].forEach(team => {
                        const symbol = document.createElement('div');
                        symbol.className = 'symbol';
                        if (this.symbols[team]) {
                            const img = this.symbols[team].cloneNode();
                            symbol.appendChild(img);
                        } else {
                            symbol.textContent = team; // Fallback if image failed to load
                        }
                        strip.appendChild(symbol);
                    });
                    
                    reel.appendChild(strip);
                });
            }

            updateCredits() {
                document.getElementById('credits').textContent = this.credits;
            }

            setupEventListeners() {
                document.getElementById('spin-button').addEventListener('click', () => this.spin());
                document.getElementById('bet-one').addEventListener('click', () => this.adjustBet(1));
                document.getElementById('bet-max').addEventListener('click', () => this.setBetMax());
                document.getElementById('lever').addEventListener('click', () => this.spin());
            }

            spin() {
                if (this.spinning || this.credits < this.currentBet) return;
                
                this.spinning = true;
                this.credits -= this.currentBet;
                this.updateCredits();

                const spinDurations = [2, 2.2, 2.4]; // Different durations for each reel
                const finalPositions = this.reelStrips.map(() => 
                    -(Math.floor(Math.random() * CONFIG.symbols.length) * 100)
                );

                this.reelStrips.forEach((strip, i) => {
                    strip.style.transition = `transform ${spinDurations[i]}s cubic-bezier(0.21, 0.53, 0.29, 0.99)`;
                    strip.style.transform = `translateY(${finalPositions[i]}%)`;
                });

                // After the last reel stops
                setTimeout(() => {
                    this.spinning = false;
                    this.checkWin();
                }, Math.max(...spinDurations) * 1000);
            }

            checkWin() {
                // Get visible symbols
                const visibleSymbols = this.reelStrips.map(strip => {
                    const transform = strip.style.transform;
                    const pos = parseInt(transform.match(/-?\d+/)[0]);
                    const index = Math.abs(Math.round(pos / 100)) % CONFIG.symbols.length;
                    return CONFIG.symbols[index];
                });

                // Check for matches
                const allMatch = visibleSymbols.every(sym => sym === visibleSymbols[0]);
                if (allMatch) {
                    const winAmount = this.currentBet * 10;
                    this.credits += winAmount;
                    this.updateCredits();
                    this.celebrateWin(winAmount);
                }
            }

            celebrateWin(amount) {
                const celebration = document.createElement('div');
                celebration.style.position = 'absolute';
                celebration.style.top = '50%';
                celebration.style.left = '50%';
                celebration.style.transform = 'translate(-50%, -50%)';
                celebration.style.color = '#fff';
                celebration.style.fontSize = '48px';
                celebration.style.textShadow = '0 0 10px #ff0';
                celebration.textContent = `WIN! +${amount}`;
                
                document.querySelector('.slot-machine-4k').appendChild(celebration);
                setTimeout(() => celebration.remove(), 2000);

                // Flash the winning symbols
                this.reelStrips.forEach(strip => {
                    strip.style.animation = 'win-flash 1s ease-in-out 3';
                });
            }

            adjustBet(amount) {
                if (!this.spinning) {
                    this.currentBet = Math.max(CONFIG.minBet, 
                                            Math.min(CONFIG.maxBet, this.currentBet + amount));
                }
            }

            setBetMax() {
                if (!this.spinning) {
                    this.currentBet = CONFIG.maxBet;
                }
            }
        }

        // Initialize game when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new NFLSlots();
        });
    </script>
</body>
</html>